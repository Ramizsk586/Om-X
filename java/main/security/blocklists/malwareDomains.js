
// Layer 2: Hardcoded Malware & Phishing Domains (v2.0)
// Enhanced curated list of known malicious domains with categorization
// Last updated: January 2026

const MALWARE_DOMAINS = [
  // Test domains
  "malware.test",
  "eicar.org",
  "test-malware.com",
  
  // Phishing & Social Engineering
  "phishing-login.com",
  "account-verify-security.net",
  "official-support-microsoft.tech",
  "your-pc-is-infected.site",
  "bank-secure-login.com",
  "wallet-connect-auth.net",
  "system-critical-alert.xyz",
  "verify-your-account-now.com",
  "confirm-identity-instantly.net",
  "secure-payment-verification.io",
  "urgent-action-required.xyz",
  
  // Malware Distribution
  "dark-web.xyz",
  "update-browser-critical.com",
  "get-adobe-reader.info",
  "win-error-fixer.pro",
  "mac-defender-scan.com",
  "driver-update-critical.net",
  "system-optimizer-pro.com",
  "pc-cleaner-free.xyz",
  
  // Cryptocurrency & Mining
  "free-crypto-giveaway.org",
  "coinhive.com",
  "jsecoin.com",
  "monero-miner.net",
  "crypto-mining-pool.xyz",
  "bitcoin-doubler.io",
  
  // Ransomware & Exploits
  "ransomware-tracker.abuse.ch",
  "exploit-db.com",
  "meterpreter.org",
  "beefproject.com",
  
  // Botnet C&C (Command & Control)
  "botnet-command.net",
  "zombie-network.xyz",
  "c2-server.io",
  
  // Common malware variants
  "emotet-tracker.net",
  "mirai-botnet.xyz",
  "locky-ransomware.com",
  "wannacry-payload.net",
  "notpetya-distribution.xyz",
  
  // Suspicious analytics and tracking
  "aggressive-analytics.net",
  "data-harvester.xyz",
  "identity-stealer.io"
];

// Whitelist exceptions - these domains might look suspicious but are actually safe
const MALWARE_EXCEPTIONS = [
  "abuse.ch",           // Legitimate malware tracking
  "virustotal.com",     // Legitimate security tool
  "any.run",            // Legitimate sandbox analysis
  "hybrid-analysis.com" // Legitimate malware analysis
];

/**
 * Check if a domain is in the malware blocklist
 * @param {string} domain - Domain to check
 * @returns {boolean} True if domain is malicious
 */
function isMalwareDomain(domain) {
  if (!domain) return false;
  
  // Check exceptions first
  if (MALWARE_EXCEPTIONS.some(exc => domain.endsWith(exc))) {
    return false;
  }
  
  // Check malware domains
  return MALWARE_DOMAINS.some(malware => {
    if (domain === malware) return true;
    if (domain.endsWith('.' + malware)) return true;
  });
}

/**
 * Get detailed threat info for a domain
 * @param {string} domain - Domain to analyze
 * @returns {object} Threat information
 */
function getThreatInfo(domain) {
  if (!domain) return null;
  
  const threat = MALWARE_DOMAINS.find(m => 
    domain === m || domain.endsWith('.' + m)
  );
  
  if (!threat) return null;
  
  // Categorize threat
  let category = 'Unknown Threat';
  let severity = 'medium';
  
  if (threat.includes('phishing') || threat.includes('verify') || threat.includes('account')) {
    category = 'Phishing/Social Engineering';
    severity = 'high';
  } else if (threat.includes('crypto') || threat.includes('mining') || threat.includes('coin')) {
    category = 'Cryptomining/Malware';
    severity = 'medium';
  } else if (threat.includes('ransomware') || threat.includes('botnet')) {
    category = 'Ransomware/Botnet';
    severity = 'critical';
  } else if (threat.includes('update') || threat.includes('adobe') || threat.includes('driver')) {
    category = 'Fake Software/Updates';
    severity = 'high';
  }
  
  return {
    domain: domain,
    threat: threat,
    category: category,
    severity: severity,
    blocked: true
  };
}

module.exports = { 
  MALWARE_DOMAINS,
  MALWARE_EXCEPTIONS,
  isMalwareDomain,
  getThreatInfo
};
